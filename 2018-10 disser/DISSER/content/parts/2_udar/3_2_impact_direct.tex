
\subsection{Разрешимость основного уравнения теории удара при наложении дифференциальных связей}

Покажем существование и единственность решения уравнения\upr{eq:udar_mat} для более общего случая.
Рассмотрим натуральную систему с обобщенными координатами $\q$ и кинетической энергией $T = \ddfrac{1}{2}(\mke\dotq, \dotq)$, на которую в момент времени $t^*$ мгновенно налагаются дифференциальные связи вида $\A\dotq = 0$.
При этом верно основное уравнение удара\upr{eq:udar_general}.
Будем считать также, что выполнено условие идеальности связей:
\begin{equation}\label{eq:constraints_ideal}
    \Q^T \delta\qposle = 0,
\end{equation}
где $\delta\qposle$ -- виртуальные перемещения системы после наложения связей.

Обобщенные скорости системы после наложения связей $\dqposle$ лежат в линейном подпространстве $\subspace = \ker \A$ пространства виртуальных перемещений $T_\q\M$.
В этом подпространстве можно выбрать базис, и таким образом ввести псевдоскорости на интервале после наложения связей: $\dqposle = \cstr\nuposle$, где столбцы матрицы $\cstr$ есть векторы базиса в $\subspace$.
При этом для матрицы оператора $\A$ и матрицы $\cstr$ будет выполнено:
\begin{equation}\label{eq:constraints_orth}
    \A\cstr = 0.
\end{equation}
Условие идеальности связей\upr{eq:constraints_ideal} означает, в частности, что вектор импульса ударных реакций $\Q$ лежит в подпространстве $T_\q\M$, дополнительном к $\subspace = \ker \A$, и таким образом, по лемме о множителях Лагранжа \cite{KarapetyanKugushev2010} представляется в базисе, составленном из строк матрицы $\A$: $\Q = \A^T\lagr$, где $\lagr$ -- множители Лагранжа.

Уравнение удара\upr{eq:udar_general} тогда можно представить в виде:
\begin{equation}\label{eq:udar_mat_At}
    \mke\cstr\nuposle - \A^T\lagr = \mke\dqdo.
\end{equation}
% где вместо матрицы $\mK$, приведенной в разделе~\ref{sect:impact_classical}, стоит любая матрица оператора связей~$\A$.

Равенство\upr{eq:udar_mat_At} есть система алгебраических уравнений относительно вектора неизвестных $(\nuposle, \lagr)^T$. Матрица $(\mke\cstr; -\A^T)$ этой системы -- невырожденная квадратная размера~$\dim~\q~\times~\dim~\q$, поскольку столбцы $\cstr$ и $\A^T$ образуют базисы в дополнительных подпространствах $T_\q\M = \mathbb{R}^{\dim \q}$. Доказательство невырожденности этой матрицы носит технический характер и проведено в Приложении. Таким образом, задача теории удара в рассматриваемом случае всегда имеет решение, решение единственно и доставляет одновременно значения обобщенных скоростей после удара $\dqposle = \cstr\nuposle$ и импульсов ударных реакций~$\Q = \A^T\lagr$.

Отметим также, в силу основного уравнения удара\upr{eq:udar_general} и условия идеальности\upr{eq:constraints_ideal}, мгновенное наложение связей можно рассматривать как абсолютно неупругий удар при котором теряется компонента $\deltadq$ вектора обобщенных скоростей $\dqdo$, ортогональная подпространству $\subspace$ в кинетической метрике:
\begin{equation*}
    \deltadq^T\mke\delta\q = 0.
\end{equation*}
Тогда вектор обобщенных скоростей после удара $\subspace \ni \dqposle = \dqdo - \deltadq$ вычисляется непосредственно как проекция вектора $\dqdo$ на подпространство $\subspace$, минуя получение импульсов ударных реакций $\Q$. Явный вид матрицы $\A$ также не требуется, достаточно ввести псевдоскорости: $\dqposle = \cstr\nuposle$.
Выражение для $\nuposle$ тогда может быть получено следующим образом:
\begin{equation*}
    0 = \cstr^T\Q = \cstr^T\mke\deltadq = \cstr^T\mke(\cstr\nuposle - \dqdo) = \cstr^T\mke\cstr\nuposle - \cstr^T\mke\dqdo,
\end{equation*}
откуда:
\begin{equation*}
\eqnuposleproj.
\end{equation*}

Эту же формулу можно получить и из уравнения\upr{eq:udar_mat_At}, домножая его слева на $\cstr^T$ и пользуясь равенством\upr{eq:constraints_orth}. Симметрично, при умножении\upr{eq:udar_mat_At} слева на $\A\mke^{-1}$, имеем выражение для множителей Лагранжа $\lagr$:
\begin{equation*}
    \lagr = -(\A \mke \A^T)^{-1}\A\dqdo,
\end{equation*}
не включающее явно матрицу связей $\cstr$.

Вернемся к рассмотрению экипажа с омни-колесами. Покажем, как связаны матрица $\mK$ и вектор импульсов ударных реакций $\F$ в координатах $OXY$ с изложенными общими утверждениями.
Рассмотрим вектор $\mathbf{r} = ( x_1, y_1, z_1 \ldots, x_N, y_N, z_N )^T$, составленный из координат точек колес, находящихся в контакте с опорной плоскостью $C_i$ в неподвижной системе отсчета $OXYZ$.
Матрица $\A$ связей\upr{eq:constraints_vec} может быть получена, например, как матрица Якоби зависимости вектора $\mathbf{r}$ от обобщенных координат $\q$: $\A(\q) = \ddfrac{\partial \mathbf{r}(\q)}{\partial \q}\bigg|_{x,y}$.
Непосредственный подсчет показывает, что столбцы матрицы Якоби, соответствующие оси $OZ$, нулевые, и потому их следует исключить.
При этом матрица $\A^T$ в точности совпадает с матрицей $\mK$ из~раздела~\ref{sect:impact_classical}, и таким образом, вектор множителей Лагранжа $\lagr$ совпадает с вектором реакций $\F$.
