\subsection{Основное уравнение теории удара}\label{sect:impact_classical}
Составим алгебраические уравнения, связывающие значения псевдоскоростей после удара и величины ударных импульсов. В течение бесконечно малого времени $\Delta t$ наложены только геометрические связи, так что скорости $\dot{\mathbf{q}}$ независимы. Запишем уравнение удара в обобщенных координатах \cite{Vilke}:
\begin{equation}\label{eq:udar_general}
\eqDeltaqQ,
\end{equation}
где $\mke$ -- матрица кинетической энергии без учета связей (так что $\M^* = \cstr^T \mke \cstr$), а $\Q$ -- вектор импульсов ударных реакций в обобщенных координатах:
\begin{equation*}
\eqQ
\end{equation*}
Исходя из геометрии системы (см. фиг.~\ref{fig:react}), получаем, что компоненты этого вектора связаны с касательными составляющими ударных реакций следующим образом (верхний индекс в $F_i^\cdot$ означает проекцию на соответствующую ось неподвижной системы отсчета):
\begin{eqnarray*}
\eqQiOne \\
\eqQiTwo \\
\eqQiTheta \\
\eqQChii \\
\eqQPhii \\
\eqQs
\end{eqnarray*}
В матричном виде:

\begin{equation*}
% \eqQKFmat
\eqQKF
\end{equation*}
\begin{equation*}
\mK = \K
\end{equation*}
Размерность матрицы $\mK$ равна $(3 + N(n+1)) \times 2N$, её ранг максимален и равен $(3 + N(n+1))$, что можно показать непосредственным вычислением.

Непосредственно перед ударом связи, запрещающие проскальзывание роликов, выходящих из контакта, снимаются.
К моменту окончания удара аналогичные связи налагаются на вновь входящие в контакт ролики.
\begin{equation*}
\eqqnu
\end{equation*}
Отсюда уравнение \upr{eq:udar_general} принимает вид:
\begin{equation}\label{eq:udar_mat}
\eqMVnuKF
\end{equation}
В следющем пункте будет доказано, что полученная линейная система алгебраических уравнений относительно $\nuposle$ и $\F$ допускает единственное решение.

% Либо в матричной форме
% \begin{equation*}
% \eqMVnuKFmat
% \end{equation*}

% Решение тогда получается следующим образом
% \begin{equation*}
% \eqMVnuKFmatres
% \end{equation*}
% где матрица $\mvk$ обратима в силу геометрии системы.