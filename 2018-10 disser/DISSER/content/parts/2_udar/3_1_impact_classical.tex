\subsection{Основное уравнение теории удара}\label{sect:impact_classical}

Составим алгебраические уравнения, связывающие значения псевдоскоростей после удара и величины ударных импульсов. В течение бесконечно малого времени $\Delta t$ наложены только геометрические связи, так что скорости $\dot{\mathbf{q}}$ независимы. Запишем основное уравнение удара в обобщенных координатах \cite{Vilke}:
\begin{equation}\label{eq:udar_general}
\eqDeltaqQ,
\end{equation}
где $\mke$ -- матрица кинетической энергии без учета связей (так что матрица кинетической энергии с учетом связей $\M^* = \cstr^T \mke \cstr$ (см. также раздел \ref{sect:eqs} главы 1)), а $\Q$ -- вектор импульсов ударных реакций в обобщенных координатах:
\begin{equation*}
\eqQ
\end{equation*}
Исходя из геометрии системы, получаем, что компоненты этого вектора связаны с касательными составляющими ударных реакций следующим образом. Компоненты касательных реакций вдоль неподвижных осей $OX$, $OY$ показаны на фиг.~\ref{fig:react}. Компоненты реакций вдоль оси $OZ$ равны нулю, поскольку в рассматриваемой конфигурации колеса внешняя граница проекции тел всех роликов на плоскость колеса есть окружность, и скорость точки ролика, первой оказывающейся в контакте с опорной плоскостью, параллельна опорной плоскости. Верхний индекс в $F_i^\cdot$ означает проекцию на соответствующую ось неподвижной системы отсчета.
\begin{eqnarray*}
\eqQiOne \\
\eqQiTwo \\
\eqQiTheta \\
\eqQChii \\
\eqQPhii \\
\eqQs
\end{eqnarray*}
В матричном виде:

\begin{equation*}
% \eqQKFmat
\eqQKF
\end{equation*}
\hspace{-30pt}
\begin{equation*}
\mK = \K
\end{equation*}
Размер матрицы $\mK$ равен $(3 + N(n+1)) \times 2N$, её ранг максимален и равен $(3 + N(n+1))$, что можно показать непосредственным вычислением.

В момент удара происходит мгновенное снятие связей, запрещающих проскальзывание роликов, выходящих из контакта и мгновенное наложение аналогичных связей на вновь входящие в контакт ролики:
\begin{equation*}
\eqqnu
\end{equation*}
Отсюда уравнение \upr{eq:udar_general} принимает вид:
\begin{equation}\label{eq:udar_mat}
\eqMVnuKF.
\end{equation}
В следющем пункте будет доказано, что полученная линейная система алгебраических уравнений относительно $\nuposle$ и $\F$ допускает единственное решение.

% Либо в матричной форме
% \begin{equation*}
% \eqMVnuKFmat
% \end{equation*}

% Решение тогда получается следующим образом
% \begin{equation*}
% \eqMVnuKFmatres
% \end{equation*}
% где матрица $\mvk$ обратима в силу геометрии системы.