
\section{Численные эксперименты}

Проведены численные эксперименты с движением экипажа по инерции для трех вариантов начальных условий (см. рис.~\ref{fig:nu_impact}).
\begin{enumerate}[wide]
    \item \label{sol:self_rot} Платформа экипажа имеет ненулевую угловую скорость относительно вертикальной оси, проходящей через центр масс экипажа; центр масс платформы покоится ($\nu_1(0) = \nu_2(0) = 0, \nu_3(0) = 1$) (рис.~\ref{fig:nu_impact_1},~\ref{fig:self_rot}).
    \item \label{sol:straight} Центр масс платформы имеет ненулевую скорость в направлении от центра экипажа к центру первого колеса, угловая скорость платформы равна нулю ($\nu_1(0) = 1, \nu_2(0) = \nu_3(0) = 0$) (рис.~\ref{fig:nu_impact_2},~\ref{fig:straight}).
    \item \label{sol:wrench} Платформа экипажа имеет ненулевую угловую скорость относительно вертикальной оси, проходящей через центр масс экипажа, и центр масс платформы имеет ненулевую скорость в направлении от центра экипажа к центру первого колеса ($\nu_1(0) = 1, \nu_2(0) = 0, \nu_3(0) = 1$) (рис.~\ref{fig:nu_impact_3},~\ref{fig:wrench}).
\end{enumerate}
Такие же варианты начальных условий рассмотрены в \cite{GerasimovZobovaPMM2018}, где используется упрощенная модель изменения обобщенных скоростей при смене контакта.

\begin{figure}
    \centering
    \begin{subfigure}[t]{0.3\textwidth}
        \centering
        \asyinclude{content/pic/asy/pic_nu_self_rot.asy}
        \caption{Движение $1$}
        \label{fig:nu_impact_1}
    \end{subfigure}
    \quad
    \begin{subfigure}[t]{0.3\textwidth}
        \centering
        \asyinclude{content/pic/asy/pic_nu_straight.asy}
        \caption{Движение $2$}
        \label{fig:nu_impact_2}
    \end{subfigure}
    \quad
    \begin{subfigure}[t]{0.3\textwidth}
        \centering
        \asyinclude{content/pic/asy/pic_nu_wrench.asy}
        \caption{Движение $3$}
        \label{fig:nu_impact_3}
    \end{subfigure}
    \caption{Рассмотренные варианты начальных условий}
    \label{fig:nu_impact}
\end{figure}
    
Расчеты выполнены для симметричного трехколесного экипажа ($\alpha_i = \frac{2\pi}{N}(i - 1), N = 3$) с $n = 5$ роликами на колесе. Все величины, участвующие в уравнениях, безразмерны. В безразмерных единицах радиусы платформы и колеса $R = 0.15$ и $r = 0.05$, массы платформы, колеса и ролика $1$, $0.15$ и $0.05$, и момент инерции $B$ ролика относительно его оси вращения положен равным $B \approx 1.6 \cdot 10^{-5}$. Таково значение осевого момента инерции цилиндра радиуса $\ddfrac{l-r}{2}$, где $r = l\cos\ddfrac{\pi}{n}$.
% Для безынерционной модели массо-инерционные характеристики колес положим соответствующими экипажу с пятью заблокированными роликами.

% Заметим, что снятие и наложение связей в момент контакта, вообще говоря, означает изменение системы уравнений движения. Однако в силу симметрии колеса, система после смены отличается от системы до смены лишь нумерацией роликов и углами поворота колес $\chi_i$.
% (ВАРИАНТ) % Стыковку гладких участков выполним, исходя из соображений, которые поясним на следующем примере. Рассмотрим два момента смены контакта на одном из колес: переход с ролика $1$ на ролик $2$ и переход с ролика $n - 1$ на ролик $1$. В силу симметрии колеса, система, перешедшая на второй ролик с первого, эквивалентна системе, перешедшей с ролика $n - 1$ на первый, с точностью до нумерации роликов и значений угла поворота колеса.
% Чтобы не менять вид уравнений движения -- а точнее, вид матрицы связей $\cstr$ -- выполним переобозначение в момент смены контакта и получим решение на следующем гладком участке, как решение той же системы уравнений, но с новыми начальными условиями. При смене ($\chi_i = \chi_i^+$) заменим $\chi_i = \chi_i^+$ на $\chi_i = \chi_i^-$ и циклически перенумеруем ролики. Если колесо поворачивается против часовой стрелки $\dot{\chi_i} > 0$ (см. рис.~\ref{fig:wheel}), сдвинем индексы вперед: $j \rightarrow j+1\mod n$. Также восстановим значения обобщенных скоростей до удара $\dqdo = \cstr\nudo$, и переобозначим углы поворота роликов $\phi_{ij}$ и псевдоскорости свободных роликов после удара $\nu^+_{s(i, j)}$ соответственно выполненной перенумерации роликов. При вращении колеса в другую сторону, выполним симметричные преобразования.

Во всех трех случаях наблюдается убывание кинетической энергии скачками в моменты смены контакта. В промежутки времени между сменами энергия остается постоянной, что свидетельствует о точности вычислений.

В вариантах \ref{sol:self_rot} и \ref{sol:straight} заметны переходные режимы вращения роликов в начале движения, когда колесо совершает первый оборот, и каждый ролик проходит полный круг, выходя из контакта и возвращаясь в него снова.

В случае \ref{sol:self_rot} масс экипажа покоится, платформа экипажа вращается вокруг вертикальной оси, проходящей через ее центр. При этом угловая скорость платформы $\nu_3$ в среднем медленно убывает (немонотонно), уменьшается на 5\%  за безразмерное время $10^3$ от начала движения. На графике на рис.~\ref{fig:self_rot_nu3} представлен интервал $t < 25$.  Кинетическая энергия системы также медленно убывает, см. рис.~\ref{fig:self_rot_T}, причем на более длительном интервале $0 < t < 1000$ виден характер убывания кинетической энергии $T$, отражающий близкий к линейному характер убывания угловой скорости платформы экипажа $\nu_3$. На рис.~\ref{fig:self_rot_dphi} приведены скорости собственного вращения роликов на первом колесе $\dot{\phi}_{1j}$. Находящийся в контакте ролик неподвижен относительно колеса (в силу связи со скоростью центра масс, см.~(\ref{constraint_roller_contact})) при $\nu_1 = \nu_2 = 0$, чему соответствуют участки графиков, лежащие на оси абсцисс. Когда контакт этого ролика с опорной плоскостью прекращается, он начинает вращаться за счёт вращения экипажа в целом вокруг вертикальной оси (см. первый интеграл (\ref{int_free_roller}), существующий на гладких участках). После полного оборота колеса ролик приобретает некоторую скорость вращения, которую мгновенно теряет при следующем входе в контакт. В результате вся система теряет часть энергии, испытывая удар связями, запрещающими проскальзывание. Скорость $\nu_3$ вращения экипажа вокруг вертикальной оси при этом изменяется скачком (см. например $t=1, 3, 5, 7.5$ на графиках).

При движении \ref{sol:straight} угловая скорость $\nu_3$ тождественно равна нулю, центр масс совершает прямолинейное движение в направлении оси $OX$ неподвижной системы отсчета. Зависимости скорости центра масс экипажа $v = \sqrt{\nu_1^2+\nu_2^2}$ и кинетической энергии $T$ от времени показаны на рис.~\ref{fig:straight_Tv_long} и~\ref{fig:straight_Tv}. Обе величины убывают (энергия -- монотонно, скачками, с каждой сменой контакта; скорость центра масс -- в среднем). Переднее колесо не вращается вокруг своей оси и движется с опорой на один и тот же ролик. Скорость вращения этого ролика связана со скоростью центра масс согласно связи (\ref{constraint_roller_contact}), см. рис.~\ref{fig:straight_dphi_1}. Остальные ролики переднего колеса покоятся относительно экипажа. На задних колесах все ролики раскручиваются, скорости вращения показаны на рис.~\ref{fig:straight_dphi_2}. После того как все ролики побывают в контакте, их движение становится близким к периодическому.

При движении \ref{sol:wrench} центр $S$ платформы описывает спираль на плоскости $OXY$ (рис.~\ref{fig:wrench_traj}) Платформа экипажа во все время движения вращается вокруг вертикальной оси, проходящей через центр масс. Кинетическая энергия (рис.~\ref{fig:wrench_T}) убывает при каждой смене контакта. Убывает и скорость $v$ центра масс экипажа. Угловая скорость платформы экипажа $\nu_3$ растет и достигает максимума (рис.~\ref{fig:wrench_vnu3}) в момент $t^*_1 \approx 150$. Комбинацию последних двух явлений можно интерпретировать как переход кинетической энергии поступательного движения центра масс в кинетическую энергию платформы в осях Кёнига. После $t = t^*_1$ угловая скорость $\nu_3$ почти монотонно убывает (немонотонность связана с наличием первых интегралов (\ref{int_free_roller})), скорость $v_S$ центра масс $S$ экипажа становится исчезающе малой к моменту $t^*_2 \approx 300$. Фрагмент графика зависимости $v(t)$ после $t^*_2$ показан на рис.~\ref{fig:wrench_v_late}. После почти полной остановки центра масс при  $t > t^*_2$ платформа экипажа вращается вокруг вертикальной оси $SZ$, постепенно замедляясь. Угловые скорости роликов представляют собой функции времени, близкие к периодическим (характерный участок представлен на правой части рис.~\ref{fig:wrench_dphi}).

В этой главе завершено построение модели экипажа с омни-колесами с массивными роликами, движущегося по абсолютно шероховатой горизонтальной плоскости. С помощью теории удара расчет изменения обобщенных скоростей при смене ролика в контакте сведен к решению системы линейных алгебраических уравнений, имеющей единственное решение в т.ч. при кратном ударе. Проведены численные эксперименты для трех видов начальных услови. В ходе численных экспериментов обнаружен эффект быстрого убывания скорости центра масс по сравнению с угловой скоростью платформы экипажа при движении экипажа по инерции при отличных от нуля начальных значениях скорости центра масс и угловой скорости платформы. 

\newpage

% \subsection{Вокруг своей оси}

\begin{figure}[htb]
    \centering
    \minipage{0.45\textwidth}
        \vspace{-25pt}
        \begin{subfigure}[t]{\textwidth}
            \centering
            \includegraphics[width=\linewidth]{content/pic/new/impact/impact_1_T_long.png}
            \vspace{-25pt}
            \caption{Кинетическая энергия $T$ всей системы на интервале $0 < t < 1000$}
            \label{fig:self_rot_T_long}
        \end{subfigure}
        \begin{subfigure}[t]{\textwidth}
            \vspace{15pt}
            \centering
            \includegraphics[width=\linewidth]{content/pic/new/impact/impact_1_T.png}
            \vspace{-25pt}
            \caption{Кинетическая энергия $T$ всей системы на интервале $0 < t < 25$}
            \label{fig:self_rot_T}
        \end{subfigure}
    \endminipage
    \quad
    \minipage{0.45\textwidth}
        \vspace{-20pt}
        \begin{subfigure}[t]{\textwidth}
            \centering
            \includegraphics[width=\linewidth]{content/pic/new/impact/impact_1_nu3.png}
            \vspace{-25pt}
            \caption{Угловая скорость $\nu_3$ платформы экипажа}
            \label{fig:self_rot_nu3}
        \end{subfigure}
        \begin{subfigure}[t]{\textwidth}
            \vspace{20pt}
            \centering
            \includegraphics[width=\linewidth]{content/pic/new/impact/impact_1_dphi.png}
            \vspace{-25pt}
            \caption{Угловые скорости роликов на колесе 1.}
            \label{fig:self_rot_dphi}
        \end{subfigure}
    \endminipage

    \caption{Движение 1 ($\nu_{1,2}(0) = 0, \nu_3(0) = 1$) экипажа на абсолютно шероховатой плоскости.}
    \label{fig:self_rot}
\end{figure}

% \begin{figure}[ht]
%     \subf{0.3\textwidth}{
%         \centering
%         \includegraphics[scale=0.33]{content/pic/self_rot_25/kin_en.eps}
%         \caption{Кинетическая энергия}
%         \label{fig:self_rot_25_kin_en}
%     }
%     \hspace{10pt}
%     \subf{0.3\textwidth}{
%         \centering
%         \includegraphics[scale=0.33]{content/pic/self_rot_25/nu3.eps}
%         \caption{Угловая скорость экипажа}
%         \label{fig:self_rot_25_nu3}
%     }
%     \hspace{10pt}
%     \subf{0.3\textwidth}{
%         \centering
%         \includegraphics[scale=0.33]{content/pic/self_rot_25/rol_vel.eps}
%         \caption{Угловые скорости роликов}
%         \label{fig:self_rot_25_rol_vel}
%     }
%     \newline
%     \subf{0.3\textwidth}{
%         \centering
%         \includegraphics[scale=0.33]{content/pic/self_rot_25/chi.eps}
%         \caption{Углы поворота колес}
%         \label{fig:self_rot_25_chi}
%     }
%     \hspace{10pt}
%     \subf{0.3\textwidth}{
%         \centering
%         \includegraphics[scale=0.33]{content/pic/self_rot_25/theta.eps}
%         \caption{Угол поворота экипажа}
%         \label{fig:self_rot_25_theta}
%     }
%     \hspace{10pt}
%     \subf{0.3\textwidth}{
%         \centering
%         \includegraphics[scale=0.33]{content/pic/self_rot_25/rol_ang.eps}
%         \caption{Углы поворота роликов}
%         \label{fig:self_rot_25_rol_ang}
%     }
%     \caption{Вращение экипажа вокруг своей оси}
%     \label{fig:self_rot}
% \end{figure}

\newpage

% \subsection{По прямой}

\begin{figure}[htb]
    \centering
    \minipage{0.45\textwidth}
        \begin{subfigure}[t]{\textwidth}
            \centering
            \includegraphics[width=\linewidth]{content/pic/new/impact/impact_2_Tv_long.png}
            \vspace{-25pt}
            \caption{Абсолютная величина $v$ скорости центра масс экипажа и кинетическая энергия $T$ всей системы на интервале $0 < t < 1000$}
            \label{fig:straight_Tv_long}
        \end{subfigure}
        \begin{subfigure}[t]{\textwidth}
            \vspace{15pt}
            \centering
            \includegraphics[width=\linewidth]{content/pic/new/impact/impact_2_Tv.png}
            \vspace{-25pt}
            \caption{Абсолютная величина $v$ скорости центра масс экипажа и кинетическая энергия $T$ всей системы на интервале $0 < t < 10$}
            \label{fig:straight_Tv}
        \end{subfigure}
    \endminipage
    \quad
    \minipage{0.45\textwidth}
        \vspace{-20pt}
        \begin{subfigure}[t]{\textwidth}
            \centering
            \includegraphics[width=\linewidth]{content/pic/new/impact/impact_2_dphi_1.png}
            \vspace{-25pt}
            \caption{Угловая скорость собственного вращения ролика с номером $1$ на переднем колесе}
            \label{fig:straight_dphi_1}
        \end{subfigure}
        \begin{subfigure}[t]{\textwidth}
            \vspace{20pt}
            \centering
            \includegraphics[width=\linewidth]{content/pic/new/impact/impact_2_dphi_2.png}
            \vspace{-25pt}
            \caption{Угловые скорости роликов на колесе номер 2 (одном из задних).}
            \label{fig:straight_dphi_2}
        \end{subfigure}
    \endminipage

    \caption{Движение 2 ($\nu_{1}(0) = 1, \nu_{2,3}(0) = 0$) экипажа на абсолютно шероховатой плоскости.}
    \label{fig:straight}
\end{figure}

% \begin{figure}[ht]
%     \hspace{-20pt}
%     \subf{0.22\textwidth}{
%         \centering
%         \includegraphics[scale=0.22]{content/pic/straight_60/kin_en.png}
%         \caption{Кинетическая энергия}
%         \label{fig:straight_60_kin_en}
%     }
%     \hspace{20pt}
%     \subf{0.4\textwidth}{
%         \centering
%         \includegraphics[scale=0.43]{content/pic/straight_60/v.png}
%         \caption{Скорость центра масс}
%         \label{fig:straight_60_v}
%     }
%     % \hspace{10pt}
%     \subf{0.35\textwidth}{
%         \centering
%         \includegraphics[scale=0.38]{content/pic/straight_60/nus2.png}
%         \caption{Угловые скорости роликов на заднем колесе}
%         \label{fig:straight_60_nus2}
%     }
%     \newline
%     \subf{0.3\textwidth}{
%         \centering
%         \includegraphics[scale=0.36]{content/pic/straight_60/nu3.png}
%         \caption{Угловая скорость экипажа}
%         \label{fig:straight_60_nu3}
%     }
%     \hspace{10pt}
%     \subf{0.3\textwidth}{
%         \centering
%         \includegraphics[scale=0.55]{content/pic/straight_60/traj.png}
%         \caption{Траектория}
%         \label{fig:straight_60_traj}
%     }
%     \hspace{10pt}
%     \subf{0.3\textwidth}{
%         \centering
%         \includegraphics[scale=0.33]{content/pic/straight_60/nus1.png}
%         \caption{Угловые скорости роликов на переднем колесе}
%         \label{fig:straight_60_nus1}
%     }
%     \newline
%     \subf{0.3\textwidth}{
%         \centering
%         \includegraphics[scale=0.33]{content/pic/straight_60/xy.png}
%         \caption{Координаты центра масс}
%         \label{fig:straight_60_xy}
%     }
%     \hspace{10pt}
%     \subf{0.3\textwidth}{
%         \centering
%         \includegraphics[scale=0.43]{content/pic/straight_60/phi1.png}
%         \caption{Углы поворота роликов на переднем колесе}
%         \label{fig:straight_60_phi1}
%     }
%     \hspace{10pt}
%     \subf{0.3\textwidth}{
%         \centering
%         \includegraphics[scale=0.33]{content/pic/straight_60/phi2.png}
%         \caption{Углы поворота роликов на заднем колесе}
%         \label{fig:straight_60_phi2}
%     }
%     \caption{Движение экипажа по прямой}
%     \label{fig:straight}
% \end{figure}

\newpage

% \subsection{С закруткой}

\begin{figure}[htb]
    \centering
    \minipage{0.45\textwidth}
        \begin{subfigure}[t]{\textwidth}
            \centering
            \includegraphics[width=\linewidth]{content/pic/new/impact/impact_3_vnu3.png}
            \vspace{-25pt}
            \caption{Абсолютная величина $v$ скорости центра масс экипажа и угловая скорость платформы $\nu_3$}
            \label{fig:wrench_vnu3}
        \end{subfigure}
        \begin{subfigure}[t]{\textwidth}
            \vspace{15pt}
            \centering
            \includegraphics[width=\linewidth]{content/pic/new/impact/impact_3_T.png}
            \vspace{-25pt}
            \caption{Кинетическая энергия экипажа}
            \label{fig:wrench_T}
        \end{subfigure}
        \begin{subfigure}[t]{\textwidth}
            \vspace{15pt}
            \centering
            \includegraphics[width=\linewidth]{content/pic/new/impact/impact_3_v_late.png}
            \vspace{-25pt}
            \caption{Абсолютная величина $v$ скорости центра масс экипажа на фрагменте интервала времени после почти полного прекращения поступательного движения центра масс, за исключением показанной величины скорости.}
            \label{fig:wrench_v_late}
        \end{subfigure}
    \endminipage
    \quad
    \minipage{0.45\textwidth}
        \vspace{-35pt}
        \begin{subfigure}[t]{\textwidth}
            \centering
            \includegraphics[width=\linewidth]{content/pic/new/impact/impact_3_traj.png}
            \vspace{-25pt}
            \caption{Траектория центра масс экипажа на плоскости $OXY$}
            \label{fig:wrench_traj}
        \end{subfigure}
        \begin{subfigure}[t]{\textwidth}
            \vspace{20pt}
            \centering
            \includegraphics[width=\linewidth]{content/pic/new/impact/impact_3_dphi.png}
            \vspace{-25pt}
            \caption{Угловые скорости роликов на колесе номер 1. Слева -- на интервале $t < 200$, справа -- на фрагменте интервала времени после почти полного прекращения поступательного движения центра масс.}
            \label{fig:wrench_dphi}
        \end{subfigure}
    \endminipage

    \caption{Движение 3 ($\nu_{1}(0) = 1, \nu_{2}(0) = 0, \nu_{3}(0) = 1$) экипажа на абсолютно шероховатой плоскости.}
    \label{fig:wrench}
\end{figure}

% \begin{figure}[ht]
%     \subf{0.3\textwidth}{
%         \centering
%         \includegraphics[scale=0.33]{content/pic/wrench_1000/kin_en.eps}
%         \caption{Кинетическая энергия}
%         \label{fig:wrench_1000_kin_en}
%     }
%     \hspace{10pt}
%     \subf{0.3\textwidth}{
%         \centering
%         \includegraphics[scale=0.33]{content/pic/wrench_1000/v.eps}
%         \caption{Скорость центра масс}
%         \label{fig:wrench_1000_v}
%     }
%     \hspace{10pt}
%     \subf{0.3\textwidth}{
%         \centering
%         \includegraphics[scale=0.33]{content/pic/wrench_1000/nu3.eps}
%         \caption{Угловая скорость экипажа}
%         \label{fig:wrench_1000_nu3}
%     }
%     \newline
%     \subf{0.45\textwidth}{
%         \centering
%         \includegraphics[scale=0.33]{content/pic/wrench_1000/traj.eps}
%         \caption{Траектория центра масс}
%         \label{fig:wrench_1000_traj}
%     }
%     \hspace{10pt}
%     \subf{0.45\textwidth}{
%         \centering
%         \includegraphics[scale=0.33]{content/pic/wrench_1000/theta.eps}
%         \caption{Угол поворота экипажа}
%         \label{fig:wrench_1000_theta}
%     }
%     \newline
%     \subf{0.45\textwidth}{
%         \centering
%         \includegraphics[scale=0.33]{content/pic/wrench_1000/nus1.eps}
%         \caption{Угловые скорости роликов на переднем колесе}
%         \label{fig:wrench_1000_nus1}
%     }
%     \hspace{10pt}
%     \subf{0.45\textwidth}{
%         \centering
%         \includegraphics[scale=0.33]{content/pic/wrench_1000/phi1.eps}
%         \caption{Углы поворота роликов на переднем колесе}
%         \label{fig:wrench_1000_phi1}
%     }
%     \caption{Движение экипажа с закруткой}
%     \label{fig:wrench}
% \end{figure}

\newpage