%\section{Переход между роликами}
{\bf 4. Переход между роликами.}
\stepcounter{section}
Уравнения (\ref{eq:full_system}) описывают динамику системы на промежутках времени, в течение которых не происходит смены роликов. 
При переходе любого колеса с одного ролика на другой коэффициенты уравнений терпят разрыв второго рода из-за выражений $\rho_i = l\cos\chi_i-r$ в знаменателе.

\begin{figure}
    \minipage{0.5\textwidth}
        \centering
        \asyinclude{./asy/pic_overlap.asy}
        \caption{Ролики перекрываются}
        \label{fig:overlap}
    \endminipage
    \minipage{0.5\textwidth}
        \centering
        \asyinclude{./asy/pic_change.asy}
        \caption{Переход между роликами}
        \label{fig:change}
    \endminipage
\end{figure}

Заметим, что в технических реализациях омни-колес ситуация $\rho_i = 0$ никогда не имеет места, т.к. концы роликов усекаются (в частности, потому что оси роликов в реальных системах имеют ненулевую толщину и должны быть закреплены в колесах). Для того, чтобы в каждый момент в контакте между колесом и плоскостью был ролик, их располагают в два или больше рядов. %Это приводит, впрочем, к скачкам расстояния между точкой контакта и центром масс ситемы в моменты смены роликов.

Для исследования движений, на которых происходят смены контактных роликов, примем следующие предположения. Мы усечем ролики (см. рис.~\ref{fig:overlap}), но оставим их оси в одной плоскости, допуская пересечение тел роликов в пространстве и пренебрегая им. Переход между роликами одного колеса будет происходить при значении угла $\chi_i = \frac{2\pi}{n}$. Колесо с усеченными роликами определим, располагая ось ролика на расстоянии $r = l\cos\frac{\pi}{n-1}$ от центра колеса (знаменатель на единицу меньше количества роликов), а его поверхность задавая как фигуру вращения дуги окружности радиуса $l$ с углом раствора $\frac{2\pi}{n}$ вокруг этой оси, замкнутую соответствующими дисками.

Кроме этого, при смене контакта происходит мгновенное наложение связи на вновь вошедший в контакт ролик и снятие её с освободившегося. При смене роликов в реальной системе происходит взаимодействия типа ударных, в том числе проскальзывание роликов относительно плоскости. Моделирование этих эффектов не входит в рамки настоящей статьи. Опираясь на наблюдения за реальными системами, которые демострируют довольно ``гладкое'' поведение, будем считать, что скорости $\nu_1$, $\nu_2$, $\nu_3$, описывающие движение платформы, при переходе с ролика на ролик не изменяются. При существенном превышении массы платформы над массами роликов такое предположение представляется разумным. Из уравнений (\ref{constraint_wheel_contact}, \ref{constraint_roller_contact}) тогда получим, 
что ролик, входящий в контакт, мгновенно приобретает ту же угловую скорость, что и освобождающийся ролик.

Для этого, отбросим уравнения
$$
\Lambda\dot{\nu}_{ni+j} = -\dot{\nu}_3\sin(\chi_i+\kappa_j) - \dot{\chi_i}\nu_3\cos(\chi_i+\kappa_j), \quad i = 1..n, j = 2..n,
$$
описывающие движение свободных роликов, и при переходе ($\chi_i = \chi_i^+$) сохраним значения $\nu_1$, $\nu_2$, 
$\nu_3$, заменим $\chi_i$ с $\chi_i^+$ на $\chi_i^-$ (см. рис.~\ref{fig:change}), а $\dot\chi_i$ пересчитаем по уравнениям связей.
