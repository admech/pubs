%\section{Явные виды выражений}
{\bf 6. Приложение. Явные виды выражений.}
\stepcounter{section}
Матрица кинетической энергии:
$$
\M = \begin{bmatrix}
    M &   &               &   &        &   &                        &        &                        \\
      & M &               &   &        &   &                        &        &                        \\
      &   & I_S           &   & \cdots &   & B\sin(\chi_k+\kappa_1) & \cdots & B\sin(\chi_N+\kappa_n) \\
      &   &               & J &        &   &                        &        &                        \\
      &   &               &   & \ddots &   &                        &        &                        \\
      &   &               &   &        & J &                        &        &                        \\
      &   & \text{\huge*} &   &        &   & B                      &        &                        \\
      &   &               &   &        &   &                        & \ddots &                        \\
      &   &               &   &        &   &                        &        & B                      \\
\end{bmatrix},
$$
где в третьей строке сначала указаны элементы $B\sin(\chi_k + \kappa_1)$, соответствующие роликам, находящимся в контакте, а затем -- $B\sin(\chi_i + \kappa_j), i = 1,\ldots,N, j = 2,\ldots,n$, соответствующие ``свободным'' роликам, упорядоченные по возрастанию индексов так, что ролики одного колеса соседствуют.

Матрица связей:
$$
V = \begin{bmatrix}
    \begin{matrix}
        R\cos\theta                  & -R\sin\theta                  & 0                    \\[6pt]
        R\sin\theta                  &  R\cos\theta                  & 0                    \\[6pt]
        0                            & 0                             & \frac{1}{\Lambda}    \\[6pt]
        \frac{R\sin\alpha_i}{l}      & -\frac{R\cos\alpha_i}{l}      & -\frac{R}{\Lambda l} \\[6pt]
        \frac{R\cos\alpha_k}{\rho_k} &  \frac{R\sin\alpha_k}{\rho_k} & 0                    \\[6pt]
    \end{matrix}   & \text{\huge 0}                \\[50pt]
    \text{\huge 0} & \text{\huge E}_{N(n-1)} \quad \\[10pt]
\end{bmatrix}.
$$

Элементы матрицы кинетической энергии с учетом связей:

\begin{equation}\label{mstar}
    \begin{array}{rcl}
        m^*_{11} & = & MR^2 + \sum\limits_i \bigg( J\ddfrac{R^2}{l^2}\sin^2\alpha_i + B\ddfrac{R^2}{\rho_i^2}\cos^2\alpha_i\bigg),\vsp
        m^*_{22} & = & MR^2 + \sum\limits_i \bigg(J\ddfrac{R^2}{l^2}\cos^2\alpha_i + B\ddfrac{R^2}{\rho_i^2}\sin^2\alpha_i\bigg),\vsp
        m^*_{33} & = & \ddfrac{1}{\Lambda}(I_S + \sum\limits_i J\ddfrac{R^2}{l^2}),\vsp
        m^*_{12} & = & \sum\limits_i \bigg(-J\ddfrac{R^2}{l^2} + B\ddfrac{R^2}{\rho_i^2}\bigg)\sin\alpha_i\cos\alpha_i,\vsp
        m^*_{13} & = & \ddfrac{1}{\Lambda}\sum\limits_i %\bigg(-J\ddfrac{R^2}{l^2}\sin\alpha_i +
        B\ddfrac{R\sin\chi_i}{\rho_i}\cos\alpha_i%\bigg)
        ,\vsp
        m^*_{23} & = & \ddfrac{1}{\Lambda}\sum\limits_i %\bigg(J\ddfrac{R^2}{l^2}\cos\alpha_i + 
        B\ddfrac{R\sin\chi_i}{\rho_i}\sin\alpha_i%\bigg)
        .\vsp
    \end{array}
\end{equation}

Формальные импульсы $\vec{p} = \ddpd{L}{\dot{\vec{q}}}$:

\begin{equation}\label{p}
    \begin{array}{rcl}
        p_x & = & MR(\nu_1\cos\theta-\nu_2\sin\theta),\vsp
        p_y & = & MR(\nu_1\sin\theta+\nu_2\cos\theta),\vsp
        p_\theta & = & BR\sum\limits_i\ddfrac{\sin(\chi_i + \kappa_1)}{\rho_i}(\nu_1\cos\alpha_i + \nu_2\sin\alpha_i) + \ddfrac{I_S}{\Lambda}\nu_3 + B\sum\limits_s\sin(\chi_s)\nu_s,\vsp
        p_{\chi_i} & = & J\ddfrac{R}{l}(\nu_1\sin\alpha_i - \nu_2\cos\alpha_i - \ddfrac{1}{\Lambda}\nu_3),\vsp
        p_{\phi_{k1}} & = & \ddfrac{BR}{\rho_k}(\nu_1\cos\alpha_k + \nu_2\sin\alpha_k) + \ddfrac{B}{\Lambda}\nu_3\sin(\chi_k+\kappa_1),\vsp
        p_{\phi_s} & = & \ddfrac{B}{\Lambda}\nu_3\sin\chi_s + B\nu_s.
    \end{array}
\end{equation}

Линейные комбинации $P_\alpha$:
\begin{equation}\label{bigP}
    \begin{array}{rcl}
        P_1 & = & R\bigg(p_x\cos\theta + p_y\sin\theta + \sum\limits_{i}\bigg(\ddfrac{\sin\alpha_ip_{\chi_i}}{l} +  \ddfrac{\cos\alpha_ip_{\phi_{i1}}}{\rho_i}\bigg)\bigg),\vsp
        P_2 & = & R\bigg(-p_x\sin\theta + p_y\cos\theta + \sum\limits_{i}\bigg(-\ddfrac{\cos\alpha_ip_{\chi_i}}{l} +  \ddfrac{\sin\alpha_ip_{\phi_{i1}}}{\rho_i}\bigg)\bigg),\vsp
        P_3 & = & \ddfrac{1}{\Lambda}\bigg(p_\theta + \sum\limits_{i}\ddfrac{R}{l}p_{\chi_i}\bigg),\vsp
        P_s & = & p_{\phi_s},
    \end{array}
\end{equation}
где от $\chi_i$ зависят $p_{\phi_{i1}}, p_\theta, \rho_i$ (см.\upr{p}), а потому и $P_1$ и $P_2$, отвечающие проекциям скорости центра масс платформы на подвижные оси, а также $P_3$, соответствующий вращению платформы.

Для упрощения записи правой части уравнений введем обозначение для операции дискретной свертки произвольной функции $f$:
$$
\sigma[f(\alpha,\chi)] = \sum\limits_{k=1}^{N} f(\alpha_k,\chi_k) \frac{\sin\chi_k}{\rho_k^3}
$$

Тогда скобки Пуассона в правой части имеют вид (звездочкой обозначена подстановка канонических формальных импульсов $p_i$):
%; дополнительно введено обозначение $\tau_k = \ddfrac{\sin\chi_k}{\rho_k^2}$):


\begin{eqnarray*}
(\{P_1,P_2\})^* &=& (-\sum\limits_{k=1}^{N} R^2\tau_kp_{\phi_k})^* =
-BR^2(R\nu_1 \sigma[\cos\alpha] + R\nu_2 \sigma[\sin\alpha] + \Lambda^{-1}\nu_3\sigma[\rho\sin\chi]) = \\
&=& -BR^2\prhs_{12}\vec{\nu}, \text{ где }\prhs_{12} =
(\sigma[\cos\alpha], R\sigma[\sin\alpha], \Lambda^{-1}\sigma[\rho\sin\chi], 0,\dots,0)
\end{eqnarray*}
%$$
%S_1^1 = \sum\limits_{k=1}^{N}\frac{\cos\alpha_k}{\rho_k}\tau_k,\
%S_2^1 = \sum\limits_{k=1}^{N}\frac{\sin\alpha_k}{\rho_k}\tau_k,\
%S_3^1 = \sum\limits_{k=1}^{N}\sin\chi_k\tau_k,
%$$

\begin{eqnarray*}
(\{P_1,P_3\})^* &=& {R}{\Lambda}^{-1}\left(-\sin\theta p_x + \cos\theta p_y - \sum\limits_{k=1}^{N} R\cos\alpha_k\tau_kp_{\phi_k}\right)^* = {MR^2}{\Lambda}^{-1}\nu_2 -\\
&-& {BR^2}{\Lambda}^{-1}(R\nu_1 \sigma[\cos^2\alpha] + R\nu_2 \sigma[\sin\alpha\cos\alpha] + \Lambda^{-1}\nu_3\sigma[\rho\cos\alpha\sin\chi])=\\
&=& {MR^2}{\Lambda}^{-1}\nu_2-{BR^2} \prhs_{13}\vec{\nu},\\
\text{ где }\prhs_{13} &=& \Lambda^{-1}
(R\sigma[\cos^2\alpha], R\sigma[\sin\alpha\cos\alpha], \Lambda^{-1}\sigma[\rho\cos\alpha\sin\chi], 0,\dots,0)
\end{eqnarray*}
%$$
%S_1^2 = \sum\limits_{k=1}^{N}\cos\alpha_k\frac{\cos\alpha_k}{\rho_k}\tau_k,\
%S_2^2 = \sum\limits_{k=1}^{N}\cos\alpha_k\frac{\sin\alpha_k}{\rho_k}\tau_k - \frac{M}{BR},
%$$$$
%S_3^2 = \sum\limits_{k=1}^{N}\cos\alpha_k\sin\chi_k\tau_k,
%$$

\begin{eqnarray*}
(\{P_2,P_3\})^* &=& {R}{\Lambda}^{-1}\left(-\cos\theta p_x - \sin\theta p_y - \sum\limits_{k=1}^{N} R\sin\alpha_k\tau_kp_{\phi_k}\right)^*  = -{MR^2}{\Lambda}^{-1}\nu_1 -\\
&-& {BR^2}{\Lambda}^{-1}(R\nu_1\sigma[\sin\alpha\cos\alpha] + R\nu_2\sigma[\sin^2\alpha]+\Lambda^{-1}\nu_3\sigma[\rho\sin\alpha\sin\chi] =
\\
&=&-{MR^2}{\Lambda}^{-1}\nu_1 -{BR^2}\prhs_{23}\vec{\nu},\\
\text{ где }\prhs_{23} &=& \Lambda^{-1}
(R\sigma[\sin\alpha\cos^\alpha], R\sigma[\sin^2\alpha], \Lambda^{-1}\sigma[\rho\sin\alpha\sin\chi], 0,\dots,0),
\end{eqnarray*}
%$$
%S_1^3 = \sum\limits_{k=1}^{N}\sin\alpha_k\frac{\cos\alpha_k}{\rho_k}\tau_k + \frac{M}{BR},\
%S_2^3 = \sum\limits_{k=1}^{N}\sin\alpha_k\frac{\sin\alpha_k}{\rho_k}\tau_k,
%$$$$
%S_3^3 = \sum\limits_{k=1}^{N}\sin\alpha_k\sin\chi_k\tau_k,
%$$
%$$
%\{P_\alpha, P_\beta\} =0,\ \alpha,\beta >3
%$$


$$
(\{P_1,P_2\})^* = (-\sum\limits_{k=1}^{N} R^2\tau_kp_{\phi_k})^* =
-BR^2(R\nu_1 S_1^1 + R\nu_2 S_2^1 + \Lambda^{-1}\nu_3S_3^1)$$
$$
S_1^1 = \sum\limits_{k=1}^{N}\frac{\cos\alpha_k}{\rho_k}\tau_k,\
S_2^1 = \sum\limits_{k=1}^{N}\frac{\sin\alpha_k}{\rho_k}\tau_k,\
S_3^1 = \sum\limits_{k=1}^{N}\sin\chi_k\tau_k,
$$

\begin{eqnarray*}
(\{P_1,P_3\})^* &=& \frac{R}{\Lambda}\left(-\sin\theta p_x + \cos\theta p_y - \sum\limits_{k=1}^{N} R\cos\alpha_k\tau_kp_{\phi_k}\right)^* =\\
&=& -\frac{BR^2}{\Lambda}(R\nu_1 S_1^2 + R\nu_2 S_2^2 + \Lambda^{-1}\nu_3S_3^2),
\end{eqnarray*}
$$
S_1^2 = \sum\limits_{k=1}^{N}\cos\alpha_k\frac{\cos\alpha_k}{\rho_k}\tau_k,\
S_2^2 = \sum\limits_{k=1}^{N}\cos\alpha_k\frac{\sin\alpha_k}{\rho_k}\tau_k - \frac{M}{BR},
$$$$
S_3^2 = \sum\limits_{k=1}^{N}\cos\alpha_k\sin\chi_k\tau_k,
$$

\begin{eqnarray*}
(\{P_2,P_3\})^* &=& \frac{R}{\Lambda}\left(-\cos\theta p_x - \sin\theta p_y - \sum\limits_{k=1}^{N} R\sin\alpha_k\tau_kp_{\phi_k}\right)^*  =\\
&=& -\frac{BR^2}{\Lambda}(R\nu_1 S_1^3 + R\nu_2 S_2^3 + \Lambda^{-1}\nu_3S_3^3),
\end{eqnarray*}
$$
S_1^3 = \sum\limits_{k=1}^{N}\sin\alpha_k\frac{\cos\alpha_k}{\rho_k}\tau_k + \frac{M}{BR},\
S_2^3 = \sum\limits_{k=1}^{N}\sin\alpha_k\frac{\sin\alpha_k}{\rho_k}\tau_k,
$$$$
S_3^3 = \sum\limits_{k=1}^{N}\sin\alpha_k\sin\chi_k\tau_k,
$$
$$
\{P_\alpha, P_\beta\} =0,\ \alpha,\beta >3
$$

TODO: ДОПИСАТЬ $\ddfrac{d}{dt}\pd{L^{*}}{\nu_\alpha}$