\section{Уравнения движения}

Воспользуемся лаконичным методом получения уравнений движения для систем с дифференциальными связями, предложенным Я.В.~Татариновым \cite{Tatarinov}:
\begin{equation}\label{Tatarinov}
    \frac{d}{dt}\frac{\partial L^{*}}{\partial \nu_\alpha}  + \{P_\alpha, L^{*}\} = \{P_\alpha, \nu_\mu P_\mu\}, 
\end{equation}
$$\nu_\mu P_\mu = \dot{q_i} p_i, \hspace{10pt} p_i = \frac{\partial L}{\partial \dot{q}_i},$$
где $P_\alpha, p_i$ -- формальные ``импульсы'', $L$ -- лагранжиан, $L^*$ -- он же с учетом связей, $\{\cdot, \cdot\}$ -- формальная скобка Пуассона.

Кинетическая энергия системы имеет вид:
\begin{equation}\label{kin_en}
    2T = 2L = M\vec{v}_S^2 + I_S\dot{\theta}^2 + J\sum_i\dot{\chi}_i^2 + B\sum_{i,j}(\dot{\phi}_{ij}^2 + 2\dot{\theta}\sin(\kappa_j + \chi_i)\dot{\phi}_{ij}),
\end{equation}
Здесь полная масса системы -- $M = \mathring{M} + Nnm$, момент инерции всей системы относительно $SZ$ -- $I_S = \mathring{I_S} + Nn(\frac{A+B}{2} + mR^2 + \frac{mr^2}{2})$, момент инерции колеса (с роликами) относительно его оси $J = \mathring{J} + n(A + mr^2)$, где $\mathring{M}, \mathring{I_S}, \mathring{J}$ -- масса и моменты инерции системы и колес без учета роликов; $m$ -- масса ролика; $A$ -- момент инерции ролика относительно любой оси, перпендикулярной его оси собственного вращения и проходящей через его центр масс; $r$ -- радиус диска колеса (расстояние от центра колеса до центра ролика), $B$ -- момент инерции ролика относительно его оси вращения.

Лагранжиан с учетом связей имеет вид:
$$ 2L^{*} = \nu M^*\nu = \nu^T V^TMV\nu, $$
где $M, V$ -- матрицы кинетической энергии и связей (см. приложение),
$$
M^* = \begin{bmatrix}
        (m^*_{ij}) \quad & \begin{matrix} 0 \\ 0 \\ \ddfrac{B}{\Lambda}\sin(\chi_i+\kappa_j) \end{matrix} \\[25pt]
        *          & BE_{N(n-1)}                                                                  \\
    \end{bmatrix},
$$
где $i,j$ соответствуют только свободным роликам и упорядочены так же, как $\nu_s$, $E$ -- единичная матрица указанной размерности,
$$ m^*_{11} = MR^2 + \sum\limits_i \bigg( J\ddfrac{R^2}{l^2}\sin^2\alpha_i + B\ddfrac{R^2}{\rho_i^2}\cos^2\alpha_i\bigg), $$
$$ m^*_{22} = MR^2 + \sum\limits_i \bigg(J\ddfrac{R^2}{l^2}\cos^2\alpha_i + B\ddfrac{R^2}{\rho_i^2}\sin^2\alpha_i\bigg), $$
$$ m^*_{33} = \ddfrac{1}{\Lambda}(I_S + \sum\limits_i J\ddfrac{R^2}{l^2}), $$
$$ m^*_{12} = \sum\limits_i \bigg(-J\ddfrac{R^2}{l^2} + B\ddfrac{R^2}{\rho_i^2}\bigg)\sin\alpha_i\cos\alpha_i, $$
$$ m^*_{13} = \ddfrac{1}{\Lambda}\sum\limits_i \bigg(-J\ddfrac{R^2}{l^2}\sin\alpha_i +  B\ddfrac{R\sin\chi_i}{\rho_i}\cos\alpha_i\bigg), $$
$$ m^*_{23} = \ddfrac{1}{\Lambda}\sum\limits_i \bigg(J\ddfrac{R^2}{l^2}\cos\alpha_i +  B\ddfrac{R\sin\chi_i}{\rho_i}\sin\alpha_i\bigg).$$


