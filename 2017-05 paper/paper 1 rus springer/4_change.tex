%\section{Переход между роликами}
{\bf 4. Смена роликов.}
\stepcounter{section}
Уравнения (\ref{eq:full_system}) описывают динамику системы на промежутках времени, в течение которых не происходит смены роликов. 
При смене роликов любого колеса коэффициенты уравнений терпят разрыв второго рода из-за выражений $\rho_i = l\cos\chi_i-r$ в знаменателе.

% \begin{figure}
%     \minipage{0.5\textwidth}
%         \centering
%         \asyinclude{./asy/pic_overlap.asy}
%         \caption{Ролики перекрываются}
%         \label{fig:overlap}
%     \endminipage
%     \minipage{0.5\textwidth}
%         \centering
%         \asyinclude{./asy/pic_change.asy}
%         \caption{Переход между роликами}
%         \label{fig:change}
%     \endminipage
% \end{figure}

Заметим, что на практике ситуация $\rho_i = 0$ никогда не реализуется, так как концы роликов усекаются (в частности, потому что оси роликов в реальных системах имеют ненулевую толщину и должны быть закреплены в колесах). Для того чтобы в каждый момент в контакте между колесом и плоскостью был ролик, ролики располагают в два или больше рядов. %Это приводит, впрочем, к скачкам расстояния между точкой контакта и центром масс ситемы в моменты смены роликов.

\marginpar{\hspace{.8cm}\boxed{\mbox{Фиг.~\ref{fig:overlap_and_change}}}}
Для исследования движений, на которых происходят смены роликов, примем следующие предположения. Усечем ролики (см. левую часть фиг.~\ref{fig:overlap_and_change}), но оставим их оси в одной плоскости, пренебрегая пересечением тел роликов в пространстве. Смена роликов одного колеса будет происходить при значении угла $\chi_i = \ddfrac{2\pi}{n}$. Колесо с усеченными роликами определим, располагая ось ролика на расстоянии $r = l\cos\ddfrac{\pi}{n-1}$ от центра колеса
%(знаменатель на единицу меньше количества роликов)
, а его поверхность задавая как фигуру вращения дуги окружности радиуса $l$ с углом раствора $\ddfrac{2\pi}{n}$ вокруг этой оси, замкнутую соответствующими дисками.

Кроме этого, при смене контакта происходит мгновенное наложение связи на вновь вошедший в контакт ролик и снятие ее с освободившегося, после чего последний может свободно вращаться вокруг своей оси. В этот момент в реальной системе происходят взаимодействия типа ударных, в том числе проскальзывание роликов относительно плоскости, при котором происходит уменьшение полной энергии системы. Однако моделирование этих эффектов здесь не рассматривается. Будем считать, что скорости $\nu_1$, $\nu_2$, $\nu_3$ при смене роликов не изменяются, как и в безынерционной модели в отсутствии роликов ($B = 0$).  Таким образом, масса роликов влияет на динамику системы только на гладких участках движения и не учитывается при смене роликов. Из уравнений (\ref{constraint_roller_contact}) и (\ref{constraint_wheel_contact}) получим, что ролик, входящий в контакт, мгновенно приобретает ту же угловую скорость, что и освобождающийся ролик.

Таким образом, при смене роликов ($\chi_i = \chi_i^+$) сохраним значения $\nu_1$, $\nu_2$, $\nu_3$, заменим $\chi_i = \chi_i^+$ на $\chi_i = \chi_i^-$ (см. правую часть фиг.~\ref{fig:overlap_and_change}), и выполним с псевдоскоростями $\nu_s$ следующее преобразование. Пусть $\vnu_i^s = (\nu_{i2},\ldots,\nu_{in})$ -- псевдоскорости свободных роликов на колесе $i$. Тогда, если при смене контакта $\dot{\chi_i} > 0$ (т.е. колесо поворачивается против часовой стрелки, см. левую часть фиг.~\ref{fig:wheel}), то отбросим $\nu_{in}$, остальные компоненты вектора $\vnu_i^s$ перенумеруем, сдвигая их индексы вперед: $\nu_{ij} \rightarrow \nu_{ij+1}$, а компоненту $\nu_{i2}$ положим равной значению правой части в уравнении связи\upr{constraint_roller_contact}. При вращении колеса в другую сторону, выполним аналогичные преобразования.
