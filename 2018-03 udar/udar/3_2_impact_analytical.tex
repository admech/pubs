
\subsection{Разрешимость основного уравнения теории удара при наложении дифференциальных связей}

Обоснуем существование и единственность решения уравнения\upr{eq:udar_mat}.

Наложение на систему связей, аналогичных\upr{eq:constraints_vec}, равносильно заданию на конфигурационном многообразии дифференциальной формы $\J$ и требованию к вектору обобщенных скоростей находиться в ядре этой формы:
\begin{equation}\label{eq:constraints_form}
    \J(\q)\dqposle = 0,
\end{equation}
то есть в линейном подпространстве $\subspace = \ker \J$ пространства виртуальных перемещений $T_\q\M$. В этом подпространстве размерности $\dim \q - \rk \J$ можно выбрать базис и компоненты вектора обобщенных скоростей в этом базисе использовать как псевдоскорости: $\dqposle = \cstr\nuposle$, при этом для матрицы дифференциальной формы связей $\J$ и матрицы $\cstr$, связывающей псевдоскорости и обобщенные скорости, будет выполнено равенство:
\begin{equation}\label{eq:constraints_orth}
    \J\cstr = 0.    
\end{equation}
Налагаемые связи будем считать идеальными, то есть работу ударных импульсов на допустимых связями перемещениях равной нулю:
\begin{equation}\label{eq:constraints_ideal}
    0 = \Q^T \delta\qposle = \Q^T \cstr\delta\nuposle.
\end{equation}
Таким образом, ударные импульсы находятся в подпространстве, ортогональном $\subspace$, а значит, вектор $\Q$ может быть представлен в базисе, образованном столбцами матрицы $\J^T$: $\Q = \J^T\F$.

Для экипажа с омни-колесами, рассматриваемого здесь, матрица дифференциальной формы связей\upr{eq:constraints_vec} может быть получена, в частности, как якобиан зависимости вектора из координат точек нижних роликов колес экипажа, находящихся в контакте с опорной плоскостью, в неподвижной системе отсчета $OXYZ$, от обобщенных координат $\q$: $\J(\q) = \ddfrac{\partial \mathbf{r}(\q)}{\partial \q}$, где $\mathbf{r} = ( x_1, y_1, \ldots, x_N, y_N )^T$ (координаты вдоль оси $Z$ опущены, поскольку они учтены при введении обобщенных координат, и соответствующие им компоненты якобиана равны нулю). В этом случае $\J^T$ в точности совпадает с матрицей $\mK$ из~раздела~\ref{sect:impact_classical}.

Итак, основное уравнение удара\upr{eq:udar_general} можно записать в более общем, чем полученный для изучаемого экипажа\upr{eq:udar_mat}, виде:
\begin{equation}\label{eq:udar_mat_Jt}
    \mke\cstr\nuposle - \mathbf{\J}^T\F = \mke\dqdo,
\end{equation}
где вместо матрицы $\mK$, приведенной в разделе~\ref{sect:impact_classical}, стоит любая матрица дифференциальной формы связей.

Равенство\upr{eq:udar_mat_Jt} есть система алгебраических уравнений относительно вектора неизвестных $(\nuposle, \F)^T$. Матрица $(\mke\cstr; -\J^T)$ этой системы -- квадратная размерности $\dim \q \times \dim \q$, поскольку столбцы $\cstr$ и $\J^T$ образуют базисы в дополнительных подпространствах $\mathbb{R}^{\dim \q}$. По той же причине она невырожденна. Действительно, поскольку с одной стороны, каждая из систем столбцов $\{\cstr_{\cdot i}\}$ и $\{\J^T_{\cdot j}\}$ линейно-независима, и с другой, эти две системы взаимно ортогональны\upr{eq:constraints_orth}, то действие положительно определенного оператора $\mke$ на $\cstr$ не нарушает линейной независимости системы столбцов в целом. Показать это можно от противного, предположив существование таких чисел $x_i$ и $y_j$, не равных нулю одновременно, что $\sum_i x_i \mke \cstr_{\cdot i} + \sum_j y_j \J^T_{\cdot j} = 0$, домножив это равенство скалярно на каждый из столбцов $\{\cstr_{\cdot \alpha}\}$ и рассмотрев сумму полученных выражений: $\sum_{\alpha, i} x_i \cstr_{\cdot \alpha}^T \mke \cstr_{\cdot i} + \sum_{\alpha, j} y_j \cstr_{\cdot \alpha}^T \mke \J^T_{\cdot j} = \cstr^T \mke \cstr \mathbf{x} + \cstr^T\J^T\mathbf{y}$, где последнее слагаемое равно нулю в силу\upr{eq:constraints_orth}, а первое отлично от нуля, поскольку матрица $\cstr^T \mke \cstr$ является матрицей Грама линейно-независимой системы столбцов матрицы $\cstr$ в метрике $\mke$, а значит, невырожденна -- противоречие. Таким образом, система\upr{eq:udar_mat_Jt} имеет единственное решение.

Отметим также, что мгновенное наложение связи можно рассматривать как абсолютно неупругий удар, при котором теряется компонента $\deltadq$ вектора обобщенных скоростей $\dqdo$, ортогональная подпространству $\subspace$ в кинетической метрике, и соответственно, находить вектор обобщенных скоростей после удара $\dqposle = \dqdo - \deltadq = \mathbf{V}\nuposle \in \subspace$ можно непосредственно из условия идеальности связей\upr{eq:constraints_ideal} и основного уравнения удара\upr{eq:udar_general}, минуя вычисление величин реакций $\Q$ или $\F$ и необходимой для этого матрицы $\J$:
\begin{equation*}
    0 = \cstr^T\Q = \cstr^T\mke\deltadq = \cstr^T\mke(\cstr\nuposle - \dqdo) = \cstr^T\mke\cstr\nuposle - \cstr^T\mke\dqdo,
\end{equation*}
откуда:
\begin{equation*}
\eqnuposleproj.
\end{equation*}
Эту же формулу можно получить и из уравнения\upr{eq:udar_mat_Jt}, домножая его слева на $\cstr^T$. Симметрично, при умножении\upr{eq:udar_mat_Jt} слева на $\J\mke^{-1}$, имеем выражение для реакций:
\begin{equation*}
    \F = -(\J \mke \J^T)^{-1}\J\dqdo,
\end{equation*}
не включающее явно матрицу связей $\cstr$.
